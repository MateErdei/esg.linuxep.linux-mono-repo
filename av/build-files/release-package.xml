<?xml version="1.0" encoding="utf-8"?>
<package name="sspl-plugin-anti-virus" version="1.0.6">
    <versioning>
        <workingdir>./products/distribution/include/AutoVersioningHeaders</workingdir>
    </versioning>

    <inputs>
        <workingdir>.</workingdir>
        <!-- DIFF SEPARATION COMMENT -->
        <!--Plugin Api Candidate Build - Change values below to match the latest Candidate build of base.
            -->
        <build-asset project="linuxep" repo="everest-base">
            <release-version branch="release/2022-15" build-id="20220405093421-a71c2698c9b0fbcb045f8c25197fc11f64be8169-scZcza"/>
            <development-version branch="develop"/>
            <include artifact-path="sspl-base/pluginapi" dest-dir="input" />
            <include artifact-path="sspl-base/SDDS-COMPONENT" dest-dir="input/base-sdds" />
        </build-asset>
        <build-asset project="winep" repo="sau">
            <release-version branch="release/2022.15-linux-sdds3" build-id="20220331140049-c17460d0c68bd361a6efcb3ca3c71860266dc827-jlMH5V"/>
            <include artifact-path="Linux-x64/SDDS3-Utils" dest-dir="input/sdds3"/>
        </build-asset>

        <build-asset project="thirdparty" repo="boost">
            <release-version branch="release/sspl/Version_1_78_0" build-id="20220310141901-bdae372a9027e1760f105dc819023a49ef444765-xdQFp9"/>
            <include artifact-path="output" dest-dir="input"/>
        </build-asset>
        <build-asset project="thirdparty" repo="cmake">
            <release-version branch="release/sophos/v3.22.1" build-id="20220311114259-a491d14ee4cafa886ea85aa4ce6858d9ce163c2d-YRz6uO"/>
            <include artifact-path="cmake" dest-dir="input/cmake"/>
        </build-asset>
        <build-asset project="thirdparty" repo="gcc">
            <release-version branch="release/Version_11_2_0" build-id="20220310091547-cf8f7ca9572a3bc9a68f05138086815341a49224-cZ84iF"/>
            <include artifact-path="output" dest-dir="input"/>
        </build-asset>
        <trusted-asset artifact-path="filer5-migrate/googletest/1-8-1/EES-8928/googletest-release-1.8.1.tar.gz" dest-dir="input/."/>
        <!-- Need to compile our own messages -->
        <build-asset project="thirdparty" repo="capnproto">
            <release-version branch="release/sspl/Version_0_8_0" build-id="20220314153844-e29cb764e609e0e34cd89aadd802d528f8020536-wQNt99"/>
            <include artifact-path="capnproto" dest-dir="input"/>
        </build-asset>

        <build-asset project="thirdparty" repo="openssl">
            <release-version branch="release/sspl/Version_1_1_1n" build-id="20220401105035-fa22fd953fa7997cf90dbf895e1ece2de4a008c5-z53ZhW"/>
            <include artifact-path="output" dest-dir="input" />
        </build-asset>

        <!-- SUSI imports -->
        <build-asset project="core" repo="engine">
            <release-version branch="release/3.84.0" build-id="20211124093937-d236f0cf0b9936dc1f28f905cb241792c5747817-iL735K"/>
            <include artifact-path="libsavi_linux64_release_gcc4-9-4glibc2-3-2" dest-dir="input/susi_input/libsavi"/>
        </build-asset>

        <build-asset project="core" repo="engine">
            <release-version branch="release/3.84.0" build-id="20211124093937-d236f0cf0b9936dc1f28f905cb241792c5747817-iL735K"/>
            <include artifact-path="sophtainer_linux64_release_gcc4-9-4glibc2-3-4" dest-dir="input/susi_input/libsophtainer"/>
        </build-asset>

        <build-asset project="ec" repo="liblocalrep">
            <release-version branch="release/2.2" build-id="20210503095748-c7f51f30f6b74388b2c15efbbbd810c85de6bb09-KJUTud"/>
            <include artifact-path="release/linux64/bin" dest-dir="input/susi_input/lrlib"/>
        </build-asset>

        <trusted-asset artifact-path="filer5-migrate/model-linux-x64/1-3/212025/oempackage/linux-x64-model-gcc4.8.1.tar" dest-dir="input/susi_input/mllib"/>

        <build-asset project="ec" repo="susi">
            <release-version branch="release/1.4" build-id="20210802114022-7db456a1204f886509d4006545064d9ce5c8e60a-ozb5UA"/>
            <include artifact-path="release/centos7/libsusi" dest-dir="input/susi_input/susi/lib" />
            <include artifact-path="release/centos7/updater" dest-dir="input/susi_input/susi/lib" />
            <include artifact-path="release/centos7/interface" dest-dir="input/susi_input/susi/include" />
            <include artifact-path="release/rules" dest-dir="input/susi_input/rules" />
        </build-asset>

        <build-asset project="core" repo="httpsrequester">
            <release-version branch="release/1.2" build-id="20210729120620-2b881ec3cb0a7520d80b70997f4817cc9aca200e-hzjbTx"/>
            <include artifact-path="release/centos7/libglobalrep" dest-dir="input/susi_input/gr/lib"/>
        </build-asset>


        <!-- external dependencies -->
        <trusted-asset artifact-path="filer5-migrate/openssl/1-1-1d-6/219246/release/lib" dest-dir="input/susi_input/openssl/lib"/>

        <trusted-asset artifact-path="filer5-migrate/boost/1-69-0-93/219328/release/boost.tar.bz2" dest-dir="input/susi_input/boost"/>

        <trusted-asset artifact-path="filer5-migrate/icu/64-2-50/219250/lib/libicudata.so.64.GLOB" dest-dir="input/susi_input/icu/lib"/>
        <trusted-asset artifact-path="filer5-migrate/icu/64-2-50/219250/lib/libicui18n.so.64.GLOB" dest-dir="input/susi_input/icu/lib"/>
        <trusted-asset artifact-path="filer5-migrate/icu/64-2-50/219250/lib/libicuuc.so.64.GLOB" dest-dir="input/susi_input/icu/lib"/>

        <trusted-asset artifact-path="filer5-migrate/libarchive/64-2-7/219360/lib/libarchive.so.13.GLOB" dest-dir="input/susi_input/libarchive/lib"/>

        <trusted-asset artifact-path="filer5-migrate/luajit/2-0-5-52/219247/lib/libluajit-5.1.so.GLOB" dest-dir="input/susi_input/luajit/lib"/>
    </inputs>
    <buildcommands>
        <command mode="release,oldci">
            <program>/bin/bash</program>
            <args>./build.sh --ci --name av</args>
            <workingdir>.</workingdir>
        </command>
        <command mode="debug">
            <program>/bin/bash</program>
            <args>./build.sh --ci --name av --debug</args>
            <workingdir>.</workingdir>
        </command>
        <command mode="coverage">
            <program>/bin/bash</program>
            <args>./build.sh --ci --name av --esg-ci-coverage</args>
            <workingdir>.</workingdir>
        </command>
        <command mode="cppcheck">
            <program>/bin/bash</program>
            <args>./build.sh --ci --name av --cpp-check</args>
            <workingdir>.</workingdir>
        </command>
        <command mode="999">
            <program>/bin/bash</program>
            <args>./build.sh --ci --name av --999 --no-unit-test</args>
            <workingdir>.</workingdir>
        </command>
    </buildcommands>
    <publish>
        <workingdir>.</workingdir>
        <destdir>sspl-plugin-anti-virus</destdir>

        <release-asset artifact-path="sspl-plugin-anti-virus/SDDS-COMPONENT" source-dir="output/SDDS-COMPONENT" mode="release"/>
        <release-asset artifact-path="sspl-plugin-anti-virus/SDDS3-PACKAGE" source-dir="output/SDDS3-PACKAGE" mode="release"/>
        <release-asset artifact-path="sspl-plugin-anti-virus-999/SDDS-COMPONENT" source-dir="output/SDDS-COMPONENT" mode="999"/>

        <build-asset artifact-path="output" source-dir="output" mode="release,debug">
        </build-asset>
        <build-asset artifact-path="coverage" source-dir="output" mode="coverage">
        </build-asset>
        <logs name="build_log" source-dir="log" mode="debug,release" />
        <logs name="coverage_log" source-dir="log" mode="coverage" />

        <buildoutputs>
            <!-- rename logs for coverage builds -->
            <output name="build_log" srcfolder="log" mode="oldci"> </output>
            <output name="coverage_log" srcfolder="log" mode="oldcoverage"> </output>

            <!-- rename output for coverage builds -->
            <output name="output" srcfolder="output" artifactpath="output" mode="oldci"> </output>
        </buildoutputs>
        <publishbranches>master,develop,feature/LINUXDAR-2501-make-changes-necessary-to-use-2020.47-version-of-susi</publishbranches>
    </publish>
</package>