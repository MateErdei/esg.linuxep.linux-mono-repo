{
    "schedule": {
      "running_processes": {
        "query": "SELECT pid, path from process_events;",
        "interval": 5,
        "removed": false,
	    "snapshot": true,
        "blacklist": false,
        "description": "Retrieves the list of flags in the target system."
      },
      "host_sensor_heartbeat_check": {
        "query": "SELECT\n    timestamp,\n    datetime,\n    local_time,\n    unix_time,\n    local_timezone\nFROM time;",
        "description": "Gets the current host time information,checking whether queries are running.",
        "denylist": true,
        "interval": 3600,
        "removed": false,
        "tag": "stream"
      },
      "osquery_process": {
        "query": "SELECT pid, name, percent_processor_time,\nhandle_count, elapsed_time, start_time,\ndisk_bytes_read, disk_bytes_written,\nuser_time, system_time, total_size,\nCAST(user_time+system_time AS FLOAT) / (SELECT sum(user_time+system_time) FROM processes) AS cpu_percent\nFROM processes\nWHERE name IN ('SophosMDR.exe', 'SophosOsquery.exe', 'SophosOsqueryExtension.exe', 'SophosOSQuery', 'SophosMDR', 'SophosMTR', 'osquery', 'osquery.0');",
        "interval": 14400,
        "removed": false,
        "denylist": false,
        "description": "Retrieves Osquery and MTR process information on all platforms.",
        "tag": "stream"
      },
      "osquery_query_schedule": {
        "query": "SELECT name, interval, executions,\ndenylisted, output_size, wall_time,\nuser_time, system_time, average_memory,\n(user_time + system_time)/executions as average_time\nFROM osquery_schedule;",
        "interval": 14400,
        "removed": false,
        "denylist": false,
        "version": "4.5.0",
        "description": "Retrieves the Osquery scheduled query performance metrics for all platforms.",
        "tag": "stream"
      },
      "osquery_rocksdb_size_linux": {
        "query": "WITH files (\n  number_of_files,\n  total_size,\n  mb\n) AS (\n  SELECT count(*) AS number_of_files,\n  SUM(size) AS total_size,\n  SUM(size)/1024/1024 AS mb\n  FROM file\n  WHERE path LIKE '/opt/sophos-spl/plugins/mtr/dbos/data/osquery.db/%'\n)\nSELECT\n  number_of_files,\n  total_size,\n  mb\nFROM files\nWHERE mb > 50;",
        "interval": 86400,
        "removed": false,
        "denylist": false,
        "platform": "linux",
        "description": "Retrieves the size of Osquery RocksDB on Linux.",
        "tag": "stream"
      }
    },
    "options": {
      "schedule_splay_percent": 3,
      "logger_plugin": "tls",
      "schedule_epoch": 1563494400,
      "disable_events": "false",
      "disable_audit": "false",
      "audit_allow_config": "true",
      "events_optimize": "true",
      "events_max": 15000,
      "events_expiry": 7200,
      "table_delay": 375,
      "hash_cache_max": 1000,
      "hash_delay": 50
    },
    "decorators": {
      "always": [
        "SELECT endpoint_id AS eid FROM sophos_endpoint_id;"
        ]
    },
    "file_paths": {},
    "exclude_paths": {}
}
