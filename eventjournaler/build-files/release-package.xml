<?xml version='1.0' encoding='utf-8'?>
<package name="sspl-event-journaler-plugin" version="1.0.4">
    <versioning>
        <workingdir>./products/distribution/include/AutoVersioningHeaders</workingdir>
    </versioning>

    <inputs>
        <workingdir>.</workingdir>
        <build-asset project="linuxep" repo="everest-base">
            <release-version branch="release/Version_1_2_2"
                             build-id="20230105165814-606006af2bd8111005b887fb5442761795481be5-0kLokq"/>
            <development-version branch="develop"/>
            <include artifact-path="sspl-base/pluginapi" dest-dir="/build/input"/>
            <include artifact-path="sspl-base/SDDS-COMPONENT" dest-dir="/build/input/base-sdds"/>
            <include artifact-path="sspl-base/fake-management" dest-dir="/build/input/fake-management"/>
        </build-asset>
        <build-asset project="winep" repo="sed">
            <release-version branch="release/SED_2022.51_libs"
                             build-id="20221208212349-316be004287bdd2a180782345077cf38e5bd510b-3c7d0H"/>
            <development-version branch="develop"/>
            <include artifact-path="sed-libs-linux/JournalLib-x64" dest-dir="/build/input"/>
            <include artifact-path="sed-libs-linux/JournalReader-x64" dest-dir="/build/input"/>
        </build-asset>
        <build-asset project="winep" repo="sau">
            <release-version branch="release/sspl/Version_1_0_0"
                             build-id="20220825150631-43a7c87ceb5905f316aef54df45de777a5961022-O0LZyf"/>
            <development-version branch="develop"/>
            <include artifact-path="Linux-x64/SDDS3-Utils" dest-dir="/build/input/sdds3"/>
        </build-asset>

        <build-asset project="thirdparty" repo="capnproto">
            <release-version branch="release/sspl/Version_0_8_0"
                             build-id="20220314153844-e29cb764e609e0e34cd89aadd802d528f8020536-wQNt99"/>
            <include artifact-path="capnproto" dest-dir="/build/input"/>
        </build-asset>
        <build-asset project="thirdparty" repo="cmake">
            <release-version branch="release/sophos/v3.22.1"
                             build-id="20220412085321-29886e1a6f8ae2867207fa5c4873eaac5c6075a7-VxG3sr"/>
            <include artifact-path="cmake" dest-dir="/build/input/cmake"/>
        </build-asset>
        <build-asset project="thirdparty" repo="gcc">
            <release-version branch="release/Version_11_2_0"
                             build-id="20220310091547-cf8f7ca9572a3bc9a68f05138086815341a49224-cZ84iF"/>
            <include artifact-path="output" dest-dir="/build/input"/>
        </build-asset>
        <build-asset project="thirdparty" repo="googletest">
            <release-version branch="release/sspl/Version_1_11_0"
                             build-id="20220311153539-356cccfb1e6553d381af902d0dcc7f74379ececd-JevvWV"/>
            <include artifact-path="thirdparty/googletest/gmock-headers"
                     dest-dir="/build/input/googletest/gmock-headers/gmock"/>
            <include artifact-path="thirdparty/googletest/gmock-libs" dest-dir="/build/input/googletest/gmock-libs"/>
            <include artifact-path="thirdparty/googletest/gtest-headers"
                     dest-dir="/build/input/googletest/gtest-headers/gtest"/>
            <include artifact-path="thirdparty/googletest/gtest-libs" dest-dir="/build/input/googletest/gtest-libs"/>
        </build-asset>

        <build-asset project="em" repo="esg">
            <release-version branch="release/2023.04.1/sprint" build-id="20230207145141-775465470cd8579d3d451d6287e19d570b6fe863-A8vT3z"/>
            <development-version branch="develop"/>
            <include artifact-path="thirdparty/liblzma-linux-opt" dest-dir="/build/redist/lzma"/>
        </build-asset>
    </inputs>
    <buildcommands>
        <command mode="release">
            <program>/bin/bash</program>
            <args>./build.sh --clean --name eventjournaler</args>
            <workingdir>.</workingdir>
        </command>
        <command mode="999">
            <program>/bin/bash</program>
            <args>./build.sh --clean --name eventjournaler --999 --no-unit-test</args>
            <workingdir>.</workingdir>
        </command>
        <command mode="060">
            <program>/bin/bash</program>
            <args>./build.sh --clean --name eventjournaler --060 --no-unit-test</args>
            <workingdir>.</workingdir>
        </command>
        <command mode="coverage">
            <program>/bin/bash</program>
            <args>./build.sh --clean --name eventjournaler --bullseye</args>
            <workingdir>.</workingdir>
        </command>
        <command mode="analysis">
            <program>/bin/bash</program>
            <args>./build.sh --no-build --name sspl-template-plugin --analysis</args>
            <workingdir>.</workingdir>
        </command>
    </buildcommands>
    <publish>
        <workingdir>.</workingdir>
        <!--   Release outputs   -->
        <release-asset artifact-path="eventjournaler/SDDS-COMPONENT" source-dir="output/SDDS-COMPONENT" mode="release"/>
        <release-asset artifact-path="eventjournaler/SDDS3-PACKAGE" source-dir="output/SDDS3-PACKAGE" mode="release"/>

        <!--   non-release outputs   -->
        <build-asset artifact-path="eventjournaler/manualTools" source-dir="output/manualTools" mode="release"/>
        <build-asset artifact-path="base/base-sdds" source-dir="output/base-sdds" mode="release"/>
        <build-asset artifact-path="base/fake-management" source-dir="output/fake-management" mode="release"/>
        <build-asset artifact-path="symbols" source-dir="output/symbols" mode="release"/>
        <build-asset artifact-path="build_log" source-dir="output" mode="release">
            <include glob="./build.log"/>
        </build-asset>

        <!--   999, 060 outputs   -->
        <release-asset artifact-path="eventjournaler-999/SDDS-COMPONENT" source-dir="output/SDDS-COMPONENT" mode="999"/>
        <release-asset artifact-path="eventjournaler-999/SDDS3-PACKAGE" source-dir="output/SDDS3-PACKAGE" mode="999"/>
        <release-asset artifact-path="eventjournaler-060/SDDS-COMPONENT" source-dir="output/SDDS-COMPONENT" mode="060"/>
        <release-asset artifact-path="eventjournaler-060/SDDS3-PACKAGE" source-dir="output/SDDS3-PACKAGE" mode="060"/>


        <!--   Coverage outputs   -->
        <build-asset artifact-path="sspl-plugin-eventjournaler-coverage/SDDS-COMPONENT"
                     source-dir="output/SDDS-COMPONENT" mode="coverage"/>
        <release-asset artifact-path="sspl-plugin-eventjournaler-coverage/manualTools" source-dir="output/manualTools"
                       mode="coverage"/>
        <build-asset artifact-path="sspl-plugin-eventjournaler-coverage/unittest-htmlreport"
                     source-dir="output/coverage/sspl-plugin-eventjournaler-unittest" mode="coverage"/>
        <build-asset artifact-path="sspl-plugin-eventjournaler-coverage/symbols" source-dir="output/symbols"
                     mode="coverage"/>
        <build-asset artifact-path="sspl-plugin-eventjournaler-coverage/base/base-sdds" source-dir="output/base-sdds"
                     mode="coverage"/>
        <build-asset artifact-path="sspl-plugin-eventjournaler-coverage/base/fake-management"
                     source-dir="output/fake-management" mode="coverage"/>
        <build-asset artifact-path="sspl-plugin-eventjournaler-coverage/build_log" source-dir="output" mode="coverage">
            <include glob="./build.log"/>
        </build-asset>
        <build-asset artifact-path="sspl-plugin-eventjournaler-coverage/covfile" source-dir="output/" mode="coverage">
            <include glob="./*.cov"/>
        </build-asset>
        <destdir>sspl-plugin-event-journaler</destdir>
        <publishbranches>develop,release,feature</publishbranches>
    </publish>
</package>
