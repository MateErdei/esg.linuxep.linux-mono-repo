<?xml version="1.0" encoding="utf-8"?>
<package name="sspl-edr-plugin" version="1.0.2">
    <versioning>
        <workingdir>sspl-edr-plugin-build/products/distribution/include/AutoVersioningHeaders</workingdir>
    </versioning>

    <inputs>
        <workingdir>sspl-edr-plugin-build</workingdir>
        <!-- DIFF SEPARATION COMMENT -->
        <!--Plugin Api Dev Build - This will check filer 6 getting the latest build-->
        <package name="sspl-base" version="master/%LASTGOODCOMPONENTBUILD%/sspl-base/1.0.2/output" dest="input" buildtype="dev">
            <include src="pluginapi.tar.gz" dest="."/>
             <include src="SDDS-COMPONENT"   dest="base-sdds" />
        </package>
        <!--Plugin Api Production Build - Change values below to match the latest production build of base.
            On release, make sure you build a production build of base first before building any production builds of plugins-->
        <package name="sspl-base" version="1-0-2-148/218390/output" dest="input" buildtype="prod">
            <include src="pluginapi.tar.gz" dest="."/>
             <include src="SDDS-COMPONENT"   dest="base-sdds" />
        </package>
        <package name="boostlinux11" version="1-70-0-13/218115/output" dest="input">
            <include src="boost.tar" dest="."/>
        </package>
        <package name="cmakelinux" version="3-11-2-4/213056/cmakelinux" dest="input">
            <include src="cmake-3.11.2-linux.tar.gz" dest="."/>
        </package>
        <package name="gcclinux" version="8-1-0-43/213047/gcclinux" dest="input">
            <include src="gcc-8.1.0-linux.tar.gz" dest="."/>
        </package>
        <package name="googletest" version="1-8-1/EES-8928" dest="input">
            <include src="googletest-release-1.8.1.tar.gz" dest="."/>
        </package>
        <package name="osquery-linux" version="4-0-2-1/EES-15942" dest="input">
            <include src="osquery-4.0.2_1.linux_x86_64.tar.gz" dest="."/>
        </package>
        <package name="osquerysdklinux11" version="1-0-0-32/218249/output" dest="input">
            <include src="osquerysdk.tar" dest="."/>
        </package>
        <package name="openssllinux11" version="1-1-1d-10/217518/output" dest="input">
            <include src="openssl.tar" dest="."/>
        </package>
    </inputs>
    <buildcommands>
        <!-- LINUXDAR-851 un-comment code below to allow debug build option when agreed -->
        <!--<command buildtype="prod">-->
        <command mode="release">
            <program>/bin/bash</program>
            <args>./build.sh --clean --name edr</args>
            <workingdir>sspl-edr-plugin-build</workingdir>
        </command>

        <command mode="coverage">
            <program>/bin/bash</program>
            <args>./build.sh --clean --name edr --bullseye</args>
            <workingdir>sspl-edr-plugin-build</workingdir>
        </command>
        <!--<command buildtype="dev">>
            <program>/bin/bash</program>
            <args>./build.sh - -clean - -debug - -name mtr</args> 'When put back remove spaces between hyphens'
            <workingdir>sspl-edr-plugin-build</workingdir>
        </command> -->
    </buildcommands>
    <publish>
        <workingdir>sspl-edr-plugin-build</workingdir>
        <destdir>sspl-edr-plugin</destdir>
        <buildoutputs>
            <!-- Release -->
            <output name="output" srcfolder="output" artifactpath="output" mode="debug,release"> </output>

            <!-- Coverage -->
            <output name="output" srcfolder="output" artifactpath="output" mode="coverage"> </output>

            <!-- All modes -->
            <output name="build_log" srcfolder="log"> </output>

        </buildoutputs>
        <publishbranches>master,feature,bugfix,release</publishbranches>
    </publish>
</package>
